wf.define("timeList",[],function(){return function(){var r=8,t=17,n=10,i='<li data-value="{0}" class="wf-select-option {2}">{1}<\/li>',u=function(){var n=":";return{toTime:t=>{var i=t%60;return Math.floor(t/60)+n+(i<10?"0"+i:i)},toMinutes:t=>{var i=t.split(n);return parseInt(i[0])*60+parseInt(i[1])}}}();return{render:function(f,e){var c=[],h=new Date,l=h.getHours(),a=h.getMinutes(),o,s;if(l>=t)return i.format("","下班");for(o=h.format("yyyy-MM-dd")==f?l*60+Math.ceil(a/n)*n:r*60;o<=t*60;o=o+n)s=u.toTime(o),c.push(i.format(s,s,s==e?"wf-select-option-selected":""));return c.join("")}}}()});wf.define("meeting",[],function(){return(()=>{var n=(n,t,i)=>{$.post(n,t,n=>{$.isFunction(i)&&i(n)})};return{save:(t,i)=>{n("meeting/save",t,i)},remove:(t,i)=>{n("meeting/delete",{id:t},i)}}})()});wf.define("meetingCard",[],function(){var n=wf.require("meeting"),t=wf.require("timeList");return function(i,r,u){var o=r.find(".meeting-save"),c=r.find(".meeting-delete"),l=r.find(".meeting-startTime"),a=r.find(".meeting-endTime"),e="meeting-saved",s="meeting-edit",h=$("."+e),f=n=>r.find('[name="{0}"]'.format(n)),v=function(){var n={},i={date:u},t;if(["id","title","userName","tableRoom","startTime","endTime"].forEach(t=>{n[t]=f(t)}),!n.title.val())return n.title.focus(),null;if(!n.userName.val())return n.userName.focus(),null;for(t in n)i[t]=n[t].val();return i};return l.find(".time-option").html(t.render(u,f("startTime").val())),a.find(".time-option").html(t.render(u,f("endTime").val())),o.click(function(){var t=v();t&&n.save(t,n=>{n.success&&(f("id").val(n.id),o.parent().parent().addClass(e))})}),c.click(function(){var t=f("id").val(),u=function(){r.remove();i.show()};t?n.remove(t,n=>{n.success&&u()}):u()}),h.hover(function(){$(this).hasClass(e)&&h.find("."+s).toggle()}),r.find("."+s+" .wf-btn").click(function(){r.removeClass(e);$(this).parent().hide()}),{addTo:function(n){i.hide();n.append(r)}}}});wf.require("page").render("meetingBorad",["UI.Select"],function(){var n=this,t="meeting-temp",i=wf.require("meetingCard"),f=wf.require("timeList"),r=$("."+t).remove().removeClass(t),u;r.find("[data-rendered]").removeAttr("data-rendered");$(".meeting-add").click(function(){var t=$(this),u=r.clone(),f=t.prev().find(".meeting-date").html(),e=i(t,u,f);e.addTo(t.prev());n.refresh()});u=$(".meeting-board-wrapper").find(".meeting-card");$.each(u,function(){i("",$(this),$(this).parent().find(".meeting-date").html())});n.refresh()});